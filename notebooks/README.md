# Эксперименты на линейных моделях
## Рассмотренные модели
Выбор моделей осуществлялся кроссвалидацией на 4 фолдах (кроме LinearRegression()).  
Все числовые признаки масштабировались в пайплайне внутри кроссвалидации применением Standardscaler(), категориальные признаки кодировались OHE.

В качестве дополнительной метрики взяли долю верно спрогнозированных цен, при этом ошибка недопрогноза и перепрогноза учитывалась по-разному:
- по недопрогнозов учитывали те прогнозы, которые в пределах отклонения 5%,
- по перепрогнозам - те прогнозы, которые в пределах отклонения 10%.  
Т.е. среди всех предсказанных цен на авто посчитали долю прогнозов, отличающихся от реальных цен на эти авто не более чем на 5% в сторону уменьшения и не более чем на 10% в сторону увеличения.
 
В репозитории собраны некоторые реализованные проекты

| Признаки и целевая переменная    | Модель                              | R^2<br/>трейн/тест       | MSE<br/>трейн/тест | MAE<br/>трейн/тест | Доля прогнозов<br/>с ошибкой от -5% до +10%<br/>трейн/тест |
| -------------------------------- | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| Только числовые (baseline)       | LinearRegression                    | 0,417/ 0,465             | 17,9/ 13,2         | 1,43/ 1,4          | 0,612/ 0,611                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Lasso, alpha=0,1                    | 0,399/ 0,447             | 18,5/ 13,6         | 1,27/ 1,25         | 0,67/ 0,67                                                 |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | ElasticNet, alpha=0,1, l1_ratio=0,1 | 0,403/ 0,450             | 18,4/ 13,6         | 1,3/ 1,28          | 0,65/ 0,65                                                 |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Ridge, alpha=10                     | 0,417/ 0,466             | 17,9/ 13,2         | 1,43/ 1,4          | 0,612/ 0,611                                               |
| -------------------------------- | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| Числовые и категориальные        | LinearRegression                    | 0,917/ 0,846             | 2,56/ 3,81         | 0,681/ 0,732       | 0,82/ 0,801                                                |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Lasso, alpha=0,1                    | 0,401/ 0,451             | 18,4/ 13,6         | 1,25/ 1,23         | 0,672/ 0,672                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | ElasticNet, alpha=0,1, l1_ratio=0,1 | 0,425/ 0,477             | 17,7/ 12,9         | 1,24/ 1,22         | 0,665/ 0,665                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Ridge, alpha=0,6210526315789474     | 0,905/ 0,849             | 2,91/ 3,74         | 0,707/ 0,741       | 0,814/ 0,8                                               |
| -------------------------------- | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| Числовые с добавлением           | LinearRegression                    | 0,77/ 0,823              | 7,07/ 4,37         | 0,932/ 0,913       | 0,736/ 0,733                                               |
| полиномиальных (степень 2)       | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| и категориальные                 | Lasso, alpha=0,1                    | 0,684/ 0,755             | 9,71/ 6,04         | 0,85/ 0,826        | 0,818/ 0,819                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | ElasticNet, alpha=0,1, l1_ratio=0,1 | 0,712/ 0,785             | 8,88/ 5,31         | 0,728/ 0,703       | 0,847/ 0,848                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Ridge, alpha=10                     | 0,862/ 0,884             | 4,25/ 2,87         | 0,646/ 0,643       | 0,845/ 0,841                                               |
| -------------------------------- | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| Числовые с добавлением           | LinearRegression                    | 0,923/ 0,922             | 0,105/ 0,106       | 0,228/ 0,23        | 0,938/ 0,937                                               |
| полиномиальных (степень 2)       | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
| и категориальные.                | Lasso, alpha=0,1                    | 0,835/ 0,834             | 0,225/ 0,226       | 0,352/ 0,354       | 0,907/ 0,908                                               |
| Логарифм целевой переменной      | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | ElasticNet, alpha=0,1, l1_ratio=0,1 | 0,896/ 0,895             | 0,142/ 0,143       | 0,274/ 0,275       | 0,919/ 0,921                                               |
|                                  | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |
|                                  | Ridge, alpha=3.2263157894736847     | 0,944/ 0,943             | 0,0757/ 0,0781     | 0,185/ 0,188       | 0,951/ 0,95                                               |
| -------------------------------- | ----------------------------------- | ------------------------ | ------------------ | ------------------ | ---------------------------------------------------------- |

Получили модель, построеннаую на полиномиальных и категориальных признаках, полученных после предобработки ранее созданным предобработчиком, с последующим логарифмированием целевой переменной с R2=0.94 и долей предсказанных цен в диапазоне 0,95-1,1 от реальной цены 0,95.
Полагаем, что модель весьма удачная, показывает хорошие результаты и на кроссвалидации, и на тесте. 
 
 
 